/*! Ace-diff | github.com/ace-diff/ace-diff */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.AceDiff=e():t.AceDiff=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";function i(t){this.options={},C(!0,this.options,{mode:null,theme:null,diffGranularity:D.DIFF_GRANULARITY_BROAD,lockScrolling:!1,showDiffs:!0,showConnectors:!0,maxDiffs:5e3,left:{id:"acediff-left-editor",content:null,mode:null,theme:null,editable:!0,copyLinkEnabled:!0},right:{id:"acediff-right-editor",content:null,mode:null,theme:null,editable:!0,copyLinkEnabled:!0},classes:{gutterID:"acediff-gutter",diff:"acediff-diff",connector:"acediff-connector",newCodeConnectorLink:"acediff-new-code-connector-copy",newCodeConnectorLinkContent:"&#8594;",deletedCodeConnectorLink:"acediff-deleted-code-connector-copy",deletedCodeConnectorLinkContent:"&#8592;",copyRightContainer:"acediff-copy-right",copyLeftContainer:"acediff-copy-left"},connectorYOffset:0},t),this.editors={left:{ace:ace.edit(this.options.left.id),markers:[],lineLengths:[]},right:{ace:ace.edit(this.options.right.id),markers:[],lineLengths:[]},editorHeight:null},function(t){var e,n=(new Date).getTime(),i=(new Date).getTime();t.editors.left.ace.getSession().on("changeScrollTop",function(n){e=(new Date).getTime(),i+50<e&&l(t,"left",n)}),t.editors.right.ace.getSession().on("changeScrollTop",function(i){e=(new Date).getTime(),n+50<e&&l(t,"right",i)});var o=t.diff.bind(t);t.editors.left.ace.on("change",o),t.editors.right.ace.on("change",o),t.options.left.copyLinkEnabled&&T("#"+t.options.classes.gutterID,"click","."+t.options.classes.newCodeConnectorLink,function(e){s(t,e,D.LTR)});t.options.right.copyLinkEnabled&&T("#"+t.options.classes.gutterID,"click","."+t.options.classes.deletedCodeConnectorLink,function(e){s(t,e,D.RTL)});var r=function(t,e,n){var i;return function(){var o=this,r=arguments,s=n&&!i;clearTimeout(i),i=setTimeout(function(){i=null,n||t.apply(o,r)},e),s&&t.apply(o,r)}}(function(){t.editors.availableHeight=document.getElementById(t.options.left.id).offsetHeight,t.diff()},250);window.addEventListener("resize",r)}(this),this.lineHeight=this.editors.left.ace.renderer.lineHeight,this.editors.left.ace.getSession().setMode(o(this,D.EDITOR_LEFT)),this.editors.right.ace.getSession().setMode(o(this,D.EDITOR_RIGHT)),this.editors.left.ace.setReadOnly(!this.options.left.editable),this.editors.right.ace.setReadOnly(!this.options.right.editable),this.editors.left.ace.setTheme(r(this,D.EDITOR_LEFT)),this.editors.right.ace.setTheme(r(this,D.EDITOR_RIGHT)),function(t){t.copyRightContainer=document.createElement("div"),t.copyRightContainer.setAttribute("class",t.options.classes.copyRightContainer),t.copyLeftContainer=document.createElement("div"),t.copyLeftContainer.setAttribute("class",t.options.classes.copyLeftContainer),document.getElementById(t.options.classes.gutterID).appendChild(t.copyRightContainer),document.getElementById(t.options.classes.gutterID).appendChild(t.copyLeftContainer)}(this),y(this),this.options.left.content&&this.editors.left.ace.setValue(this.options.left.content,-1),this.options.right.content&&this.editors.right.ace.setValue(this.options.right.content,-1),this.editors.editorHeight=function(t){return document.getElementById(t.options.left.id).offsetHeight}(this),this.diff()}function o(t,e){var n=t.options.mode;return e===D.EDITOR_LEFT&&null!==t.options.left.mode&&(n=t.options.left.mode),e===D.EDITOR_RIGHT&&null!==t.options.right.mode&&(n=t.options.right.mode),n}function r(t,e){var n=t.options.theme;return e===D.EDITOR_LEFT&&null!==t.options.left.theme&&(n=t.options.left.theme),e===D.EDITOR_RIGHT&&null!==t.options.right.theme&&(n=t.options.right.theme),n}function s(t,e,n){var i,o,r,s,a,c,l=parseInt(e.target.getAttribute("data-diff-index"),10),f=t.diffs[l];n===D.LTR?(i=t.editors.left,o=t.editors.right,r=f.leftStartLine,s=f.leftEndLine,a=f.rightStartLine,c=f.rightEndLine):(i=t.editors.right,o=t.editors.left,r=f.rightStartLine,s=f.rightEndLine,a=f.leftStartLine,c=f.leftEndLine);for(var d="",h=r;h<s;h++)d+=g(i,h)+"\n";var u="";for(h=0;h<a;h++)u+=g(o,h)+"\n";var p="",L=o.ace.getSession().getLength();for(h=c;h<L;h++)p+=g(o,h),h<L-1&&(p+="\n");p=p.replace(/\s*$/,"");var E=o.ace.getSession().getScrollTop();o.ace.getSession().setValue(u+d+p),o.ace.getSession().setScrollTop(parseInt(E)),t.diff()}function a(t){var e=[];return t.ace.getSession().doc.getAllLines().forEach(function(t){e.push(t.length+1)}),e}function c(t,e,n,i,o){e=t.editors[e];i<n&&(i=n);var r=o+" "+(i>n?"lines":"targetOnly");i--,e.markers.push(e.ace.session.addMarker(new b(n,0,i,1),r,"fullLine"))}function l(t,e,n){f(t),S(t),function(t){var e=t.editors.left.ace.getSession().getScrollTop(),n=t.editors.right.ace.getSession().getScrollTop();t.copyRightContainer.style.cssText="top: "+-e+"px",t.copyLeftContainer.style.cssText="top: "+-n+"px"}(t)}function f(t){t.editors.left.markers.forEach(function(t){this.editors.left.ace.getSession().removeMarker(t)},t),t.editors.right.markers.forEach(function(t){this.editors.right.ace.getSession().removeMarker(t)},t)}function d(t,e,n,i,o){var r={},s=/^\n/.test(o);if(e===D.DIFF_INSERT){var a=h(t.editors.left,n,o),c=p(t.editors.right,i),l=u(t.editors.right,c),f=u(t.editors.left,a.startLine),d=c;0===u(t.editors.left,a.startLine)&&s&&(s=!1),0===a.startChar&&L(t.editors.right,i,s)&&(d=c+1);var g=a.startLine===a.endLine,E=0;(a.startChar>0||g&&o.length<f)&&l>0&&a.startChar<f&&E++,r={leftStartLine:a.startLine,leftEndLine:a.endLine+1,rightStartLine:d,rightEndLine:d+E}}else{a=h(t.editors.right,i,o),c=p(t.editors.left,n),l=u(t.editors.left,c);var y=u(t.editors.right,a.startLine),m=c;0===u(t.editors.right,a.startLine)&&s&&(s=!1),0===a.startChar&&L(t.editors.left,n,s)&&(m=c+1);g=a.startLine===a.endLine,E=0;(a.startChar>0||g&&o.length<y)&&l>0&&a.startChar<y&&E++,r={leftStartLine:m,leftEndLine:m+E,rightStartLine:a.startLine,rightEndLine:a.endLine+1}}return r}function h(t,e,n){var i={startLine:0,startChar:0,endLine:0,endChar:0},o=e+n.length,r=0,s=!1,a=!1;t.lineLengths.forEach(function(t,n){r+=t,!s&&e<r&&(i.startLine=n,i.startChar=e-r+t,s=!0),!a&&o<=r&&(i.endLine=n,i.endChar=o-r+t,a=!0)}),i.startChar>0&&u(t,i.startLine)===i.startChar&&(i.startLine++,i.startChar=0),0===i.endChar&&i.endLine--;var c=/\n$/.test(n);return i.startChar>0&&c&&i.endLine++,i}function u(t,e){return g(t,e).length}function g(t,e){return t.ace.getSession().doc.getLine(e)}function p(t,e){for(var n=t.ace.getSession().doc.getAllLines(),i=0,o=0,r=0;r<n.length;r++)if(o+=n[r].length+1,e<=o){i=r;break}return i}function L(t,e,n){for(var i=t.ace.getSession().doc.getAllLines(),o=0,r=!1,s=0;s<i.length;s++){var a=o+=i[s].length+1;if(n&&a--,e===a){r=!0;break}}return r}function E(t){var e=document.createElement("div"),n={class:t.className,style:"top:"+t.topOffset+"px",title:t.tooltip,"data-diff-index":t.diffIndex};for(var i in n)e.setAttribute(i,n[i]);return e.innerHTML=t.arrowContent,e}function y(t){t.gutterHeight=document.getElementById(t.options.classes.gutterID).clientHeight,t.gutterWidth=document.getElementById(t.options.classes.gutterID).clientWidth;var e=m(t,D.EDITOR_LEFT),n=m(t,D.EDITOR_RIGHT),i=Math.max(e,n,t.gutterHeight);t.gutterSVG=document.createElementNS(D.SVG_NS,"svg"),t.gutterSVG.setAttribute("width",t.gutterWidth),t.gutterSVG.setAttribute("height",i),document.getElementById(t.options.classes.gutterID).appendChild(t.gutterSVG)}function m(t,e){return(e===D.EDITOR_LEFT?t.editors.left:t.editors.right).ace.getSession().getLength()*t.lineHeight}function S(t){!function(t){document.getElementById(t.options.classes.gutterID).removeChild(t.gutterSVG),y(t)}(t),function(t){t.copyLeftContainer.innerHTML="",t.copyRightContainer.innerHTML=""}(t),t.diffs.forEach(function(t,e){this.options.showDiffs&&(c(this,D.EDITOR_LEFT,t.leftStartLine,t.leftEndLine,this.options.classes.diff),c(this,D.EDITOR_RIGHT,t.rightStartLine,t.rightEndLine,this.options.classes.diff),this.options.showConnectors&&function(t,e,n,i,o){var r=t.editors.left.ace.getSession().getScrollTop(),s=t.editors.right.ace.getSession().getScrollTop();t.connectorYOffset=1;var a=e*t.lineHeight-r+.5,c=t.gutterWidth+1,l=i*t.lineHeight-s+.5,f=n*t.lineHeight-r+t.connectorYOffset+.5,d=t.gutterWidth+1,h=o*t.lineHeight-s+t.connectorYOffset+.5,u=I(-1,a,c,l)+" L"+c+","+l+" "+d+","+h+" "+I(d,h,-1,f)+" L-1,"+f+" "+-1+","+a,g=document.createElementNS(D.SVG_NS,"path");g.setAttribute("d",u),g.setAttribute("class",t.options.classes.connector),t.gutterSVG.appendChild(g)}(this,t.leftStartLine,t.leftEndLine,t.rightStartLine,t.rightEndLine),function(t,e,n){if(e.leftEndLine>e.leftStartLine&&t.options.left.copyLinkEnabled){var i=E({className:t.options.classes.newCodeConnectorLink,topOffset:e.leftStartLine*t.lineHeight,tooltip:"Copy to right",diffIndex:n,arrowContent:t.options.classes.newCodeConnectorLinkContent});t.copyRightContainer.appendChild(i)}e.rightEndLine>e.rightStartLine&&t.options.right.copyLinkEnabled&&(i=E({className:t.options.classes.deletedCodeConnectorLink,topOffset:e.rightStartLine*t.lineHeight,tooltip:"Copy to left",diffIndex:n,arrowContent:t.options.classes.deletedCodeConnectorLinkContent}),t.copyLeftContainer.appendChild(i))}(this,t,e))},t)}function C(){var t,e,n,i,o,r,s=arguments[0]||{},a=1,c=arguments.length,l=!1,f=Object.prototype.toString,d=Object.prototype.hasOwnProperty,h={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},u={isFunction:function(t){return"function"===u.type(t)},isArray:Array.isArray||function(t){return"array"===u.type(t)},isWindow:function(t){return null!==t&&t===t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null===t?String(t):h[f.call(t)]||"object"},isPlainObject:function(t){if(!t||"object"!==u.type(t)||t.nodeType)return!1;try{if(t.constructor&&!d.call(t,"constructor")&&!d.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var e;for(e in t);return void 0===e||d.call(t,e)}};for("boolean"==typeof s&&(l=s,s=arguments[1]||{},a=2),"object"===(void 0===s?"undefined":v(s))||u.isFunction(s)||(s={}),c===a&&(s=this,--a);a<c;a++)if(null!==(t=arguments[a]))for(e in t)n=s[e],s!==(i=t[e])&&(l&&i&&(u.isPlainObject(i)||(o=u.isArray(i)))?(o?(o=!1,r=n&&u.isArray(n)?n:[]):r=n&&u.isPlainObject(n)?n:{},s[e]=C(l,r,i)):void 0!==i&&(s[e]=i));return s}function I(t,e,n,i){var o=t+(n-t)/2;return"M "+t+" "+e+" C "+o+","+e+" "+o+","+i+" "+n+","+i}function T(t,e,n,i){var o="document"===t?document:document.querySelector(t);o.addEventListener(e,function(t){for(var e=o.querySelectorAll(n),r=t.target,s=0,a=e.length;s<a;s++)for(var c=r,l=e[s];c&&c!==o;){if(c===l)return i.call(l,t);c=c.parentNode}})}Object.defineProperty(e,"__esModule",{value:!0});var v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b=ace.require("ace/range").Range,D={DIFF_EQUAL:0,DIFF_DELETE:-1,DIFF_INSERT:1,EDITOR_RIGHT:"right",EDITOR_LEFT:"left",RTL:"rtl",LTR:"ltr",SVG_NS:"http://www.w3.org/2000/svg",DIFF_GRANULARITY_SPECIFIC:"specific",DIFF_GRANULARITY_BROAD:"broad"};i.prototype={setOptions:function(t){C(!0,this.options,t),this.diff()},getNumDiffs:function(){return this.diffs.length},getEditors:function(){return{left:this.editors.left.ace,right:this.editors.right.ace}},diff:function(){var t=new diff_match_patch,e=this.editors.left.ace.getSession().getValue(),n=this.editors.right.ace.getSession().getValue(),i=t.diff_main(n,e);t.diff_cleanupSemantic(i),this.editors.left.lineLengths=a(this.editors.left),this.editors.right.lineLengths=a(this.editors.right);var o=[],r={left:0,right:0};i.forEach(function(t){var e=t[0],n=t[1];0!==n.length&&(e===D.DIFF_EQUAL?(r.left+=n.length,r.right+=n.length):e===D.DIFF_DELETE?(o.push(d(this,D.DIFF_DELETE,r.left,r.right,n)),r.right+=n.length):e===D.DIFF_INSERT&&(o.push(d(this,D.DIFF_INSERT,r.left,r.right,n)),r.left+=n.length))},this),this.diffs=function(t,e){function n(e){return t.options.diffGranularity===D.DIFF_GRANULARITY_SPECIFIC?e<1:e<=1}var i=[];e.forEach(function(t,e){if(0!==e){for(var o=!1,r=0;r<i.length;r++)if(n(Math.abs(t.leftStartLine-i[r].leftEndLine))&&n(Math.abs(t.rightStartLine-i[r].rightEndLine))){i[r].leftStartLine=Math.min(t.leftStartLine,i[r].leftStartLine),i[r].rightStartLine=Math.min(t.rightStartLine,i[r].rightStartLine),i[r].leftEndLine=Math.max(t.leftEndLine,i[r].leftEndLine),i[r].rightEndLine=Math.max(t.rightEndLine,i[r].rightEndLine),o=!0;break}o||i.push(t)}else i.push(t)});var o=[];return i.forEach(function(t){t.leftStartLine===t.leftEndLine&&t.rightStartLine===t.rightEndLine||o.push(t)}),o}(this,o),this.diffs.length>this.options.maxDiffs||(f(this),S(this))},destroy:function(){var t=this.editors.left.ace.getValue();this.editors.left.ace.destroy();var e=this.editors.left.ace.container,n=e.cloneNode(!1);n.textContent=t,e.parentNode.replaceChild(n,e);var i=this.editors.right.ace.getValue();this.editors.right.ace.destroy(),(n=(e=this.editors.right.ace.container).cloneNode(!1)).textContent=i,e.parentNode.replaceChild(n,e),document.getElementById(this.options.classes.gutterID).innerHTML=""}},e.default=i}]).default});